<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="CryptoHack - Manyprimes" /><meta name="author" content="NiBi" /><meta property="og:locale" content="en" /><meta name="description" content="Instructions :" /><meta property="og:description" content="Instructions :" /><link rel="canonical" href="/posts/manyprimes/" /><meta property="og:url" content="/posts/manyprimes/" /><meta property="og:site_name" content="NiBi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-20T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CryptoHack - Manyprimes" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@NiBi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"NiBi"},"dateModified":"2022-06-20T23:03:09+00:00","datePublished":"2022-06-20T00:00:00+00:00","description":"Instructions :","headline":"CryptoHack - Manyprimes","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/manyprimes/"},"url":"/posts/manyprimes/"}</script><title>CryptoHack - Manyprimes | NiBi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="NiBi"><meta name="application-name" content="NiBi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/pp.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">NiBi</a></div><div class="site-subtitle font-italic">All my Write Ups are here !</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/NiBi8z" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>CryptoHack - Manyprimes</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>CryptoHack - Manyprimes</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/username">NiBi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655683200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-20 </em> </span> <span> Updated <em class="timeago" data-ts="1655766189" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-21 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="217 words"> <em>1 min</em> read</span></div></div></div><div class="post-content"><h3 id="instructions-"><span class="mr-2">Instructions :</span><a href="#instructions-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>We have a supercomputer at work, so I’ve made sure my encryption is secure by picking massive numbers!</p><p>source.py</p><p>output.txt</p><h3 id="solution"><span class="mr-2">Solution:</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>We have to factorise n to get Euler’s totient.</p><p>Using <a href="https://www.alpertron.com.ar/ECM.HTM">alperton</a> we can try to factor n. After 3 minutes of computing we get :</p><p><img data-src="../../assets/manyprimes.png" alt="Results" data-proofer-ignore></p><p>We have all factors, we can do (first_factor-1)*(second_factor-1)…(last_factor-1) to have Euler’s totient but the website calculated it for us.</p><p>Now, we copy&amp;paste the computed totient and compute d as e<sup>-1</sup> mod n and get the flag.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">n</span><span class="o">=</span><span class="mi">580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637</span>
<span class="n">e</span><span class="o">=</span><span class="mi">65537</span>
<span class="n">ct</span><span class="o">=</span><span class="mi">320721490534624434149993723527322977960556510750628354856260732098109692581338409999983376131354918370047625150454728718467998870322344980985635149656977787964380651868131740312053755501594999166365821315043312308622388016666802478485476059625888033017198083472976011719998333985531756978678758897472845358167730221506573817798467100023754709109274265835201757369829744113233607359526441007577850111228850004361838028842815813724076511058179239339760639518034583306154826603816927757236549096339501503316601078891287408682099750164720032975016814187899399273719181407940397071512493967454225665490162619270814464</span>

<span class="n">tot</span><span class="o">=</span><span class="s">'580642 391898 843191 487404 652150 193463 439642 600155 214610 402815 446275 117822 457602 964108 279991 178253 399797 937961 990567 828910 318944 376020 941874 995912 942457 183778 540787 232677 949141 800666 918857 974957 805860 863128 934894 322453 334083 108951 829885 566055 541321 469492 863749 601696 156719 452204 625091 396670 183612 468234 453545 730714 411260 422415 053794 985900 973204 357184 470104 831581 957188 055965 458235 216412 636167 147716 884241 110058 234315 146752 181551 500634 472836 779298 794303 330378 218517 375396 697137 335380 548442 818167 481491 481087 606998 467945 980408 909917 714107 491743 183639 877866 494931 448463 312524 563384 587536 906823 474872 320000 000000 000000'</span>

<span class="n">tot</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">tot</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)))</span>

<span class="n">d</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">tot</span><span class="p">)</span>

<span class="n">decrypt</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">decrypt</span><span class="p">))</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cryptohack/'>CryptoHack</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/challenge/" class="post-tag no-text-decoration" >Challenge</a> <a href="/tags/rsa/" class="post-tag no-text-decoration" >RSA</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/math/" class="post-tag no-text-decoration" >math</a> <a href="/tags/modular-math/" class="post-tag no-text-decoration" >modular math</a> <a href="/tags/factorization/" class="post-tag no-text-decoration" >factorization</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/tic-tac-toe-minimax/">Tic Tac Toe - AI with Minimax algorithm</a><li><a href="/posts/cryptohack-no-way-jose/">CryptoHack - No way jose</a><li><a href="/posts/RSA-STARTER-06/">CryptoHack - RSA Starter 6</a><li><a href="/posts/salty/">CryptoHack - Salty</a><li><a href="/posts/manyprimes/">CryptoHack - Manyprimes</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/challenge/">Challenge</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/math/">math</a> <a class="post-tag" href="/tags/modular-math/">modular math</a> <a class="post-tag" href="/tags/factorization/">factorization</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/thm/">THM</a> <a class="post-tag" href="/tags/aes/">AES</a> <a class="post-tag" href="/tags/easy/">easy</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cryptohack-marin-secret/"><div class="card-body"> <em class="timeago small" data-ts="1656028800" > 2022-06-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CryptoHack - Marin's Secrets</h3><div class="text-muted small"><p> Instructions : I’ve found a super fast way to generate primes from my secret list. Challenge files: marin.py output.txt marin.py : 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 ...</p></div></div></a></div><div class="card"> <a href="/posts/Inferius-prime/"><div class="card-body"> <em class="timeago small" data-ts="1655596800" > 2022-06-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CryptoHack - Inferius Prime</h3><div class="text-muted small"><p> Instructions: Here is my super-strong RSA implementation, because it’s 1600 bits strong it should be unbreakable… at least I think so! inferius.py output.txt Inferius.py : #!/usr/bin/env pytho...</p></div></div></a></div><div class="card"> <a href="/posts/everything-is-big/"><div class="card-body"> <em class="timeago small" data-ts="1655683200" > 2022-06-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CryptoHack - Everything is Big</h3><div class="text-muted small"><p> Instructions : We have a supercomputer at work, so I’ve made sure my encryption is secure by picking massive numbers! source.py output.txt Solution : Here is the content of source.py #!/usr/b...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/infinite-descent/" class="btn btn-outline-primary" prompt="Older"><p>CryptoHack - Infinite Descent</p></a> <a href="/posts/monoprime/" class="btn btn-outline-primary" prompt="Newer"><p>CryptoHack - Monoprime</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/username">NiBi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."></span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/challenge/">Challenge</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/math/">math</a> <a class="post-tag" href="/tags/modular-math/">modular math</a> <a class="post-tag" href="/tags/factorization/">factorization</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/thm/">THM</a> <a class="post-tag" href="/tags/aes/">AES</a> <a class="post-tag" href="/tags/easy/">easy</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Nothing yet :(</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
