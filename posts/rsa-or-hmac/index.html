<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="CryptoHack - RSA or HMAC" /><meta name="author" content="NiBi" /><meta property="og:locale" content="en" /><meta name="description" content="Challenge description :" /><meta property="og:description" content="Challenge description :" /><link rel="canonical" href="/posts/rsa-or-hmac/" /><meta property="og:url" content="/posts/rsa-or-hmac/" /><meta property="og:site_name" content="NiBi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-22T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CryptoHack - RSA or HMAC" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@NiBi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"NiBi"},"dateModified":"2022-06-22T00:00:00+00:00","datePublished":"2022-06-22T00:00:00+00:00","description":"Challenge description :","headline":"CryptoHack - RSA or HMAC","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/rsa-or-hmac/"},"url":"/posts/rsa-or-hmac/"}</script><title>CryptoHack - RSA or HMAC | NiBi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="NiBi"><meta name="application-name" content="NiBi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/pp.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">NiBi</a></div><div class="site-subtitle font-italic">All my Write Ups are here !</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/NiBi8z" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>CryptoHack - RSA or HMAC</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>CryptoHack - RSA or HMAC</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/username">NiBi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655856000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-22 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="560 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><p>Challenge description :</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>There's another issue caused by allowing attackers to specify their own algorithms but not carefully validating them. Attackers can mix and match the algorithms that are used to sign and verify data. When one of these is a symmetric algorithm and one is an asymmetric algorithm, this creates a beautiful vulnerability.

The server is running PyJWT with a small patch to enable an exploit that existed in PyJWT versions &lt;= 1.5.0. To create the malicious signature, you will need to patch or downgrade your PyJWT library too. Use pip show pyjwt to find the location of the PyJWT library on your computer, and edit jwt/algorithms.py to remove the line that was added in the fix for the vulnerability.


Play at http://web.cryptohack.org/rsa-or-hmac

</pre></table></code></div></div><p>Source code :</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">jwt</span> <span class="c1"># note this is the PyJWT module, not python-jwt
</span>

<span class="c1"># Key generated using: openssl genrsa -out rsa-or-hmac-private.pem 2048
</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'challenge_files/rsa-or-hmac-private.pem'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
   <span class="n">PRIVATE_KEY</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'challenge_files/rsa-or-hmac-public.pem'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
   <span class="n">PUBLIC_KEY</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">FLAG</span> <span class="o">=</span> <span class="err">?</span>


<span class="o">@</span><span class="n">chal</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/rsa-or-hmac/authorise/&lt;token&gt;/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">authorise</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">decoded</span> <span class="o">=</span> <span class="n">jwt</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">PUBLIC_KEY</span><span class="p">,</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s">'HS256'</span><span class="p">,</span> <span class="s">'RS256'</span><span class="p">])</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">"error"</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">if</span> <span class="s">"admin"</span> <span class="ow">in</span> <span class="n">decoded</span> <span class="ow">and</span> <span class="n">decoded</span><span class="p">[</span><span class="s">"admin"</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">"response"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"Welcome admin, here is your flag: </span><span class="si">{</span><span class="n">FLAG</span><span class="si">}</span><span class="s">"</span><span class="p">}</span>
    <span class="k">elif</span> <span class="s">"username"</span> <span class="ow">in</span> <span class="n">decoded</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">"response"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"Welcome </span><span class="si">{</span><span class="n">decoded</span><span class="p">[</span><span class="s">'username'</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">"error"</span><span class="p">:</span> <span class="s">"There is something wrong with your session, goodbye"</span><span class="p">}</span>


<span class="o">@</span><span class="n">chal</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/rsa-or-hmac/create_session/&lt;username&gt;/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_session</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">jwt</span><span class="p">.</span><span class="n">encode</span><span class="p">({</span><span class="s">'username'</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s">'admin'</span><span class="p">:</span> <span class="bp">False</span><span class="p">},</span> <span class="n">PRIVATE_KEY</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">'RS256'</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">"session"</span><span class="p">:</span> <span class="n">encoded</span><span class="p">}</span>


<span class="o">@</span><span class="n">chal</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/rsa-or-hmac/get_pubkey/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_pubkey</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">"pubkey"</span><span class="p">:</span> <span class="n">PUBLIC_KEY</span><span class="p">}</span>

</pre></table></code></div></div><h3 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>First, i patched by JWT asit’s requested in the description.</p><p>First of all, I noticed something strange. The token is encoded in “RS256” but the decode function accept both ‘RS256’ and ‘HS256’ algorithms. Why? If we encode data with one algorithm we need to decode this data with the same algorithm.</p><p>After that, i noticed that the “PUBLIC KEY” is at the second place in the decode function. The second parameter is also where we write the “secret key” for an HS256 algorithm.</p><p>We can have the public key thanks to get_pubkey(). We can create a token using HS256 alorithm and sign it with the public key as a secret key ! When the website will receive our token. It will decode our token and see that it’s HS256 encoded. It will use the second parameter (public_key) to check if the token is well signed. Because we used this key to sign our payload it will be correct !</p><p>I explain more how JWT works in <a href="../../posts/cryptohack-no-way-jose/">this write up</a></p><p>The decoded payload parts is :</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
</span><span class="nl">"username"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">,</span><span class="w">
</span><span class="nl">"admin"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"False"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>With python we will generate a token with the same json but we will only replace “admin” : “False” by “admin” : “True”</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">jwt</span> <span class="c1">#I patched my JWT as they said.
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="n">URL</span> <span class="o">=</span> <span class="s">'http://web.cryptohack.org//'</span>


<span class="k">def</span> <span class="nf">get_pub_key</span><span class="p">():</span> <span class="c1">#Get the RSA public key
</span>    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sa">f</span><span class="s">'/rsa-or-hmac/get_pubkey'</span><span class="p">)</span>
    <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="s">'pubkey'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data</span>


<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="n">pub_key</span><span class="o">=</span><span class="n">get_pub_key</span><span class="p">()</span>
    <span class="n">token</span><span class="o">=</span><span class="n">jwt</span><span class="p">.</span><span class="n">encode</span><span class="p">({</span><span class="s">'username'</span><span class="p">:</span><span class="s">'admin'</span><span class="p">,</span><span class="s">'admin'</span><span class="p">:</span><span class="s">'true'</span><span class="p">},</span><span class="n">pub_key</span><span class="p">,</span><span class="s">'HS256'</span><span class="p">)</span> <span class="c1">#Encoding this payload in HS256 with the public key as secret.
</span>    <span class="k">return</span> <span class="n">token</span>
</pre></table></code></div></div><p>Now, we have our admin crafted token !</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/crypto/'>Crypto</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/challenge/" class="post-tag no-text-decoration" >Challenge</a> <a href="/tags/cryptohack/" class="post-tag no-text-decoration" >Cryptohack</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >JWT</a> <a href="/tags/json/" class="post-tag no-text-decoration" >JSON</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/tic-tac-toe-minimax/">Tic Tac Toe - AI with Minimax algorithm</a><li><a href="/posts/cryptohack-no-way-jose/">CryptoHack - No way jose</a><li><a href="/posts/RSA-STARTER-06/">CryptoHack - RSA Starter 6</a><li><a href="/posts/salty/">CryptoHack - Salty</a><li><a href="/posts/manyprimes/">CryptoHack - Manyprimes</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/challenge/">Challenge</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/math/">math</a> <a class="post-tag" href="/tags/modular-math/">modular math</a> <a class="post-tag" href="/tags/factorization/">factorization</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/thm/">THM</a> <a class="post-tag" href="/tags/aes/">AES</a> <a class="post-tag" href="/tags/easy/">easy</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cryptohack-no-way-jose/"><div class="card-body"> <em class="timeago small" data-ts="1655164800" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CryptoHack - No way jose</h3><div class="text-muted small"><p> In this challenge we are suppose to exploit a code based on JSON WEB TOKENS. as explained on the “token application” challenge : JavaScript Object Signing and Encryption (JOSE) is a framework spec...</p></div></div></a></div><div class="card"> <a href="/posts/json-in-json/"><div class="card-body"> <em class="timeago small" data-ts="1655856000" > 2022-06-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CryptoHack - JSON in JSON</h3><div class="text-muted small"><p> Challenge description : We&#39;ve explored how flawed verification can break the security of JWTs, but it can sometimes be possible to exploit the code to sign unexpected data in the first place. Play...</p></div></div></a></div><div class="card"> <a href="/posts/cryptohack-marin-secret/"><div class="card-body"> <em class="timeago small" data-ts="1656028800" > 2022-06-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CryptoHack - Marin's Secrets</h3><div class="text-muted small"><p> Instructions : I’ve found a super fast way to generate primes from my secret list. Challenge files: marin.py output.txt marin.py : 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/json-in-json/" class="btn btn-outline-primary" prompt="Older"><p>CryptoHack - JSON in JSON</p></a> <a href="/posts/cryptohack-marin-secret/" class="btn btn-outline-primary" prompt="Newer"><p>CryptoHack - Marin's Secrets</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/username">NiBi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."></span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/challenge/">Challenge</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/math/">math</a> <a class="post-tag" href="/tags/modular-math/">modular math</a> <a class="post-tag" href="/tags/factorization/">factorization</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/thm/">THM</a> <a class="post-tag" href="/tags/aes/">AES</a> <a class="post-tag" href="/tags/easy/">easy</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Nothing yet :(</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
